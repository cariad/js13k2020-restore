<html><head><meta name=viewport content="width=device-width,initial-scale=1"><title>RESTORE</title><meta charset=UTF-8><style>body{margin:0}</style></head><body><canvas id=c width=800 height=600></canvas><script>var e,t,o,l=Math.floor,i=document.getElementById("c"),r=i.getContext("2d"),n=(e,t)=>e.forEach(t),a=[],f=(e,l,i,r)=>{for(var n=r/81*10,a=i,f=e?t.f:o.f,h=0;h<f.length;h++)a=9+s(e,f[h],l,a,r,n)},s=(t,o,l,i,n,a)=>{var f,s;r.fillStyle="black",r.font="bold 16px monospace",r.textAlign="left",r.fillText(o.i,l,i);var h=i+16,g=h;e&&t&&(s=e.p.find(e=>e.i==o.i),f=e.o.find(e=>e.i==o.i),(s||f)&&(h+=u(10,5,a)/2));for(var b=v(e=>{e.fillStyle=c,e.fillRect(0,0,81,10)},81,10,l,h,n,[0,0,0],0),p=0;p<8;p++)v(e=>{var t=Math.pow(2,8-p-1);e.fillStyle=(o.b&t)==t?d:m,e.fillRect(1,1,9,8)},10,10,l+p*a,h,a,[0,255,0],160);if(f)for(p=0;p<8;p++)(f.b&(w=Math.pow(2,8-p-1)))==w&&v(e=>{e.beginPath(),e.moveTo(1,4),e.lineTo(5,0),e.lineTo(6,0),e.lineTo(10,4),e.closePath(),e.fillStyle=c,e.fill(),e.strokeStyle=m,e.stroke()},10,5,l+p*a,g,a,[255,0,0],180);if(s)for(p=0;p<8;p++){var w;(s.b&(w=Math.pow(2,8-p-1)))==w&&v(e=>{e.beginPath(),e.moveTo(1,0),e.lineTo(5,4),e.lineTo(6,4),e.lineTo(10,0),e.closePath(),e.fillStyle=c,e.fill(),e.strokeStyle=m,e.stroke()},10,5,l+p*a,g,a,[0,0,255],180)}return h+b},h=()=>{var l=i.width=window.innerWidth,n=i.height=window.innerHeight,a=Math.min((l-.02*l*2)/3,(n-.02*n*2)/2),s=.02*a,h=a-2*s,v=l/2-3*a/2,u=n/2-2*a/2;r.fillStyle="lightgray",r.fillRect(0,0,l,n),r.fillStyle="black",r.font="bold 22px cursive",r.textAlign="left",r.textBaseline="top",r.fillText(`${l} x ${n}`,0,0);var c=u+s,d=u+a+s,g=v+s,m=v+a+s,p=v+a+a+s;o&&(f(!1,m,c,h),b(o,p,c,h)),b(t,g,d,h,!0),f(!0,m,d,h),e&&(r.font="bold 22px cursive",r.textAlign="center",r.textBaseline="middle",r.fillStyle="#000",r.fillText("Accept",p+h/2,d+20,h,40),r.strokeRect(p,d,h,40),w(p,d,h,40,"Accept"))},v=(e,t,o,l,i,n,a,f,s)=>{var h=document.createElement("canvas"),v=h.getContext("2d");h.width=t,h.height=o,v.lineWidth=1,e(v);for(var c=v.getImageData(0,0,t,o),d=[],g=0;g<o;g++)for(var m=0;m<t;m++){var b,p=g*(4*t)+4*(s?t-m-1:m);c.data[p+3]<128?(d.push(0),d.push(0),d.push(0),d.push(0)):(b=c.data[p+0]>=128?a:a.map(c.data[p+1]>=128?e=>e+f:e=>e-f),d.push(b[0]),d.push(b[1]),d.push(b[2]),d.push(255))}for(var w=0;w<d.length;w++)c.data[w]=d[w];v.clearRect(0,0,t,o),v.putImageData(c,0,0);var y=u(t,o,n);return r.imageSmoothingEnabled=!1,r.drawImage(h,l,i,n,y),r.imageSmoothingEnabled=!0,y},u=(e,t,o)=>o/e*t,c="#f00",d="#0f0",m="#00f",b=(e,t,o,l,i)=>{var r=(e,t)=>{e.strokeStyle=c,e.fillStyle=d,n(t,t=>{e.beginPath(),e.moveTo(t[0],t[1]),e.bezierCurveTo(t[2],t[3],t[4],t[5],t[6],t[7]),e.fill(),e.stroke()})},a=e.a;v(e=>r(e,a.hs[0]),31,31,t,o,l,a.ht,64,i),v(e=>{e.strokeStyle=c,e.fillStyle=d,p(e,5,5,20,20,a.hr)},31,31,t,o,l,a.s,40,i),v(e=>{e.fillStyle=c,e.fillRect(7,a.ey,4,a.eh),e.fillRect(11+a.eg,a.ey,4,a.eh),e.fillStyle=m,e.fillRect(8,a.ey+1,1,1),e.fillRect(11+a.eg+1,a.ey+1,1,1)},31,31,t,o,l,[255,255,255],255,i),v(e=>{e.fillStyle=m;var t=a.m[0]/3+a.m[2],o=19+a.m[1],l=a.m[0]/3*2+a.m[2],i=19+a.m[1],r=a.m[2]+a.m[0];e.beginPath(),e.moveTo(a.m[2],19),e.bezierCurveTo(t,o,l,i,r,19),e.stroke()},31,31,t,o,l,a.s,110,i),v(e=>r(e,a.hs[1]),31,31,t,o,l,a.ht,64,i)},p=(e,t,o,l,i,r)=>{e.beginPath(),e.moveTo(t+r,o),e.lineTo(t+l-r,o),e.quadraticCurveTo(t+l,o,t+l,o+r),e.lineTo(t+l,o+i-r),e.quadraticCurveTo(t+l,o+i,t+l-r,o+i),e.lineTo(t+r,o+i),e.quadraticCurveTo(t,o+i,t,o+i-r),e.lineTo(t,o+r),e.quadraticCurveTo(t,o,t+r,o),e.closePath(),e.fill(),e.stroke()},w=(e,t,o,l,i)=>a.push({x:e,y:t,w:o,h:l,t:i}),y=(new Date).getMinutes(),S=(new Date).getSeconds(),T=(e=10)=>{var t=(y+S)/100,o=l(100*(t-l(t)));return y=S,S=o,o%e},x=()=>[4,0].reduce((e,t)=>(e+=T(14)+1)<<t,0),k=e=>{console.info(e.n+" holds:"),n(e.f,e=>console.info(`> (file ID: ${(""+e.i).padStart(2,"0")}) ${A(e.b)}`))},A=e=>e.toString(2).padStart(8,0),P=()=>{t=E(!0,3,"Bob"),$()},$=()=>{var e;o=E(!0,3,((e=[])[0]=["Astro","Captain","Enchanter","Pirate","Priest","Sales Manager","g","h","i","j"][T()],e[1]=["Nigel","Fyodor","Jam","Jonas","Lucas","f","g","h","i","j"][T()],e[2]=["Keyboard","Planet","Soul","Video","e","f","g","h","i","j"][T()]+["jammer","crusher","juicer","b","e","f","g","h","i","j"][T()],e.join(" "))),D()},C=(e,t)=>{for(var o=[],l=[],i=0;i<e;i++)o.push(i);for(i=0;i<t;i++)l.push(o.splice(T(o.length),1)[0]);return l},E=(e,t,o)=>{var l={f:[],n:o,a:{s:[[197,140,133],[236,188,180],[80,51,53],[89,47,42]][T(4)].map(e=>e+1.5*(T()-4)),ht:[128*T(2),128*T(2),128*T(2)],hs:[[[],[]],[[[4,8,-6,34,20,34,8,1]],[[22,10,12,36,38,36,26,3],[26,3,-9,-6,-3,18,25,9]]],[[],[[22,6,6,-7,-7,17,21,8]]]][T(3)],hr:T(6)+3,ey:T(3)+12,eg:T(2)+2,eh:T(2)+2,m:[[10,2,8],[12,4,7]][T(2)]}};return e&&l.f.push({m:2,b:x(),i:0}),n(C(8,t),e=>l.f.push({m:1,b:x(),i:e+1})),l.f.filter(e=>0==e.b)==l.f.length?(console.error("All zeroes?!"),null):l},R=e=>{for(var t=0;e>0;)e&=e-1,t++;return t},M=(e,t)=>R(e)*t,j=(e,t)=>e.f.find(e=>e.i==t),q=e=>console.debug(`> "${A(e.b)}" of file (${e.i}) worth $${e.v}.`),I=(e,t)=>{(g=e.f.find(e=>e.i==t.i))?g.b+=t.b:e.f.push({m:1,b:t.b,i:t.i})},D=()=>{var i,r,a,f,s=(f={v:0},n((a=r=o,(i=t).f.map(e=>e.i).filter(e=>a.f.map(e=>e.i).includes(e))),e=>{var t=j(i,e),o=(j(r,e).b^t.b)&t.b,l=M(o,t.m);l>f.v&&(f.i=e,f.b=o,f.v=l)}),f.v>0?f:null);if(!s)return console.warn(`You have nothing of value to ${o.n}.`),void $();var v,u=((e,t,o)=>{var i=[];(i=e.f.map(o=>((e,t,o)=>{var l={i:o},i=j(e,o),r=j(t,o);return l.b=((r?r.b:0)^i.b)&i.b,l.v=M(l.b,i.m),l.e=i.m,l})(e,t,o.i)).filter(e=>e.b>0)).sort((e,t)=>e.v>t.v);var r=[],a=0;return n(i,e=>{if(e.v+a-o>0){var t=l((o-a)/e.e);if(!t)return;for(var i=C(8,8).map(e=>Math.pow(2,e));R(e.b)>t;){var n=i.pop();(e.b&n)==n&&(e.b-=n)}e.v=M(e.b,e.e)}r.push(e),a+=e.v}),r})(o,t,s.v);if(0==u.length)return console.warn(o.n+" has nothing of value to you."),void $();v=e={o:[s],p:u},console.info("There's an offer on the table!"),console.info(o.n+" will take:"),n(v.o,e=>q(e)),console.info(`In return, ${o.n} will offer:`),n(v.p,e=>q(e)),requestAnimationFrame(h)};i.addEventListener("click",l=>{var i=l.offsetX,r=l.offsetY,f=a.reverse().find(e=>e.x<i&&i<e.x+e.w&&e.y<r&&r<e.y+e.h);f&&("Accept"==f.t?(l=>{n(e.o,e=>I(o,e)),n(e.p,e=>I(t,e)),e=null;var i=255==j(t,0).b,r=255==j(o,0).b;i&&r||i?(console.warn("You won! :)"),k(t)):r?(console.warn(o.n+" won! :("),k(o)):(console.info(o.n+" walks away with:"),k(o),$()),requestAnimationFrame(h)})():"Again"==f.t?P():console.log(f.t))}),window.addEventListener("resize",h,!0),window.addEventListener("orientationchange",h,!0),P();</script></body></html>