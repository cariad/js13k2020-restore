<html><head><meta name=viewport content="width=device-width,initial-scale=1"><title>RESTORE</title><meta charset=UTF-8><style>body{margin:0}</style></head><body><canvas id=c width=800 height=600></canvas><script>var e,t,l,a,o,i,r,n=Math.floor,f=document.getElementById("c"),h=f.getContext("2d"),c=(e,t)=>e.forEach(t),s={p:[],o:[]},u=()=>{for(var e=f.width=window.innerWidth,t=f.height=window.innerHeight,l=(d=Math.min((e-.04*e*2)/(c=4),(t-.04*t*2)/(u=2)))-2*(g=.02*d),a=e/2-d*c/2,o=t/2-d*u/2,i=[],r=[],n=0;n<u;n++)r.push(o+g+n*(d+g));for(var h=0;h<c;h++)i.push(a+g+h*(d+g));s={w:window.innerWidth,h:window.innerHeight,p:p(!0,i[1],r[0],l),o:p(!1,i[2],r[0],l),a:{}};var c,u,d,g=.02*(d=Math.min((e-.02*e*2)/(c=4),(t-.02*t*2)/(u=2)));if(s.cpd=l,s.pa={},s.pa.x=i[0],s.pa.y=r[0],s.oa={},s.oa.x=i[3],s.oa.y=r[0],s.b=[],v){s.t={x:x=i[0],y:y=r[1],w:e=2*(l+g)+2*d,h:t=l,f:{s:l/8}};for(var b=s.t.h/10,m=(s.t.h-2*b)/62,w=[],S=10*m,T=0;T<5;T++)w.push(s.t.y+b+T*(S+3*m));var E=0;s.t.lx=s.t.x+b,s.t.l=[];var k=v.t.split(" "),C={t:"",y:w[E++]};k.forEach(e=>{C.t.length+e.length>50&&(C&&s.t.l.push(C),C={t:"",y:w[E++]}),C.t+=e+" "}),s.t.l.push(C),s.t.o=[];var A=s.t.lx,P=w[w.length-1],R=s.t.w/4.5,M=s.t.w/60;v.o.forEach(e=>{s.t.o.push({x:A,y:P,w:R,h:S,t:e,s:0}),A+=R+M})}else s.t=null},v={t:"Backstory goes here. First to restore FILE 0 wins!",o:["Start"]},p=(e,t,l,a)=>{var o=e?i:r;if(!o)return[];var n=l;return o.f.map(l=>{var o=d(e,l,t,n,a);return n+=2*o.h,o})},d=(t,l,a,o,i)=>{var r,n,f={l:{t:l.i,x:a,y:o}};o+=20,t?(r=e?e.o.find(e=>e.i==l.i):null,n=e?e.p.find(e=>e.i==l.i):null):(r=e?e.p.find(e=>e.i==l.i):null,n=e?e.o.find(e=>e.i==l.i):null);var h=i/89,c=10*h,s=1*h,u=c+2*c/9;f.x=a,f.y=o,f.w=i,f.h=u,f.c=[],f.cw=c,f.i=l.i,f.p=t;for(var v=0;v<8;v++){var p=Math.pow(2,8-v-1);f.c[v]={b:p,g:(l.b&p)==p},f.c[v].x=a+h+v*(c+s),f.c[v].y=o+s,f.c[v].to=r&&(r.b&p)==p,f.c[v].ti=n&&(n.b&p)==p,f.c[v].h=0,f.c[v].p=f}return f},b=(e,t)=>{(e?s.p:s.o).forEach(e=>m(e,t))},m=(e,t)=>{h.fillStyle="black",h.font="bold 16px monospace",h.textAlign="left",h.fillText(e.l.t,e.l.x,e.l.y);var l=new Date,a=t/89*8;h.fillStyle="black",h.fillRect(e.x,e.y,e.w,e.h);for(var o=l.getMilliseconds(),i=o>500?0:(500-o%500)/500,r=0;r<8;r++){var n=e.c[r].h?["#ff0","#660"]:["#0f0","#666"];h.fillStyle=e.c[r].g?n[0]:n[1],h.fillRect(e.c[r].x,e.c[r].y,e.cw,e.cw);var f=e.c[r].x+(e.cw-a)/2,c=.4*e.cw,s=a/4;if(e.c[r].to){var u=e.c[r].y+e.cw/6-.75*c+c*i;h.beginPath(),h.moveTo(f,u),h.lineTo(f+a,u),h.lineTo(f+a/2,u-.4*a),h.closePath(),h.fillStyle="#f00",h.fill(),h.fillRect(f+s,u,a-2*s,a/2)}e.c[r].ti&&(u=e.c[r].y+e.cw/6-.75*c+c*(1-i),h.beginPath(),h.moveTo(f,u),h.lineTo(f+a,u),h.lineTo(f+a/2,u+.4*a),h.closePath(),h.fillStyle="#00f",h.fill(),h.fillRect(f+s,u-a/2,a-2*s,a/2))}},w=()=>{f.width=s.w,f.height=s.h,h.fillStyle="lightgray",h.fillRect(0,0,s.w,s.h),h.fillStyle="black",h.font="bold 22px cursive",h.textAlign="left",h.textBaseline="top",i&&(A(i,s.pa.x,s.pa.y,s.cpd,!0),b(!0,s.cpd)),r&&(A(r,s.oa.x,s.oa.y,s.cpd,!1),b(!1,s.cpd)),h.font="bold 22px cursive",h.textAlign="center",h.textBaseline="middle",h.fillStyle="#000",s.t&&(h.fillStyle="black",h.fillRect(s.t.x,s.t.y,s.t.w,s.t.h),h.font="bold "+s.t.f.s+"px monospace",h.textAlign="left",h.textBaseline="top",h.fillStyle="white",s.t.l.forEach(e=>{h.fillText(e.t,s.t.lx,e.y)}),h.textAlign="left",s.t.o.forEach(e=>{h.fillStyle=e.s?"yellow":"white",h.fillText("[ "+e.t+" ]",e.x,e.y)})),requestAnimationFrame(w)},S=(e,t,l,a,o,i,r,n,f)=>{var c=document.createElement("canvas"),s=c.getContext("2d");c.width=t,c.height=l,s.lineWidth=1,e(s);for(var u=s.getImageData(0,0,t,l),v=[],p=0;p<l;p++)for(var d=0;d<t;d++){var g,b=p*(4*t)+4*(f?t-d-1:d);u.data[b+3]<128?(v.push(0),v.push(0),v.push(0),v.push(0)):(g=u.data[b+0]>=128?r:r.map(u.data[b+1]>=128?e=>e+n:e=>e-n),v.push(g[0]),v.push(g[1]),v.push(g[2]),v.push(255))}for(var y=0;y<v.length;y++)u.data[y]=v[y];s.clearRect(0,0,t,l),s.putImageData(u,0,0);var m=T(t,l,i);return h.imageSmoothingEnabled=!1,h.drawImage(c,a,o,i,m),h.imageSmoothingEnabled=!0,m},T=(e,t,l)=>l/e*t,E="#f00",k="#0f0",C="#00f",A=(e,t,l,a,o)=>{var i=(e,t)=>{e.strokeStyle=E,e.fillStyle=k,c(t,t=>{e.beginPath(),e.moveTo(t[0],t[1]),e.bezierCurveTo(t[2],t[3],t[4],t[5],t[6],t[7]),e.fill(),e.stroke()})},r=e.a;S(e=>i(e,r.hs[0]),31,31,t,l,a,r.ht,64,o),S(e=>{e.strokeStyle=E,e.fillStyle=k,P(e,5,5,20,20,r.hr)},31,31,t,l,a,r.s,40,o),S(e=>{e.fillStyle=E,e.fillRect(7,r.ey,4,r.eh),e.fillRect(11+r.eg,r.ey,4,r.eh),e.fillStyle=C,e.fillRect(8,r.ey+1,1,1),e.fillRect(11+r.eg+1,r.ey+1,1,1)},31,31,t,l,a,[255,255,255],255,o),S(e=>{e.fillStyle=C;var t=r.m[0]/3+r.m[2],l=19+r.m[1],a=r.m[0]/3*2+r.m[2],o=19+r.m[1],i=r.m[2]+r.m[0];e.beginPath(),e.moveTo(r.m[2],19),e.bezierCurveTo(t,l,a,o,i,19),e.stroke()},31,31,t,l,a,r.s,110,o),S(e=>i(e,r.hs[1]),31,31,t,l,a,r.ht,64,o)},P=(e,t,l,a,o,i)=>{e.beginPath(),e.moveTo(t+i,l),e.lineTo(t+a-i,l),e.quadraticCurveTo(t+a,l,t+a,l+i),e.lineTo(t+a,l+o-i),e.quadraticCurveTo(t+a,l+o,t+a-i,l+o),e.lineTo(t+i,l+o),e.quadraticCurveTo(t,l+o,t,l+o-i),e.lineTo(t,l+i),e.quadraticCurveTo(t,l,t+i,l),e.closePath(),e.fill(),e.stroke()},R=0,M=(new Date).getMinutes(),j=(new Date).getSeconds(),B=(e=10)=>{var t=(M+j)/100,l=n(100*(t-n(t)));return M=j,j=l,l%e},D=()=>[4,0].reduce((e,t)=>(e+=B(14)+1)<<t,0),q=()=>{r=F(!0,3,(e=>{var t=[];return t[0]=["Astro","Captain","Enchanter","Pirate","Priest","Sales Manager","g","h","i","j"][B()],t[1]=["Nigel","Fyodor","Jam","Jonas","Lucas","f","g","h","i","j"][B()],t[2]=["Keyboard","Planet","Soul","Video","e","f","g","h","i","j"][B()]+["jammer","crusher","juicer","b","e","f","g","h","i","j"][B()],t.join(" ")})()),Y()},L=(e,t)=>{for(var l=[],a=[],o=0;o<e;o++)l.push(o);for(o=0;o<t;o++)a.push(l.splice(B(l.length),1)[0]);return a},F=(e,t,l)=>{var a={f:[],n:l,a:{s:[[197,140,133],[236,188,180],[80,51,53],[89,47,42]][B(4)].map(e=>e+1.5*(B()-4)),ht:[128*B(2),128*B(2),128*B(2)],hs:[[[],[]],[[[4,8,-6,34,20,34,8,1]],[[22,10,12,36,38,36,26,3],[26,3,-9,-6,-3,18,25,9]]],[[],[[22,6,6,-7,-7,17,21,8]]]][B(3)],hr:B(6)+3,ey:B(3)+12,eg:B(2)+2,eh:B(2)+2,m:[[10,2,8],[12,4,7]][B(2)]}};return e&&a.f.push({m:2,b:D(),i:0}),c(L(8,t),e=>a.f.push({m:1,b:D(),i:e+1})),a.f.filter(e=>0==e.b)==a.f.length?(console.error("All zeroes?!"),null):a},I=e=>{for(var t=0;e>0;)e&=e-1,t++;return t},W=(e,t)=>I(e)*t,z=(e,t)=>e.f.find(e=>e.i==t),H=(e,t)=>{(g=e.f.find(e=>e.i==t.i))?g.b+=t.b:e.f.push({m:1,b:t.b,i:t.i})},Y=()=>{var t,l,a,o,f=(o={v:0},c((a=l=r,(t=i).f.map(e=>e.i).filter(e=>a.f.map(e=>e.i).includes(e))),e=>{var a=z(t,e),i=(z(l,e).b^a.b)&a.b,r=W(i,a.m);r>o.v&&(o.i=e,o.b=i,o.v=r)}),o.v>0?o:null);if(!f)return console.warn(`You have nothing of value to ${r.n}.`),void q();var h=((e,t,l)=>{var a=[];(a=e.f.map(l=>((e,t,l)=>{var a={i:l},o=z(e,l),i=z(t,l);return a.b=((i?i.b:0)^o.b)&o.b,a.v=W(a.b,o.m),a.e=o.m,a})(e,t,l.i)).filter(e=>e.b>0)).sort((e,t)=>e.v>t.v);var o=[],i=0;return c(a,e=>{if(e.v+i-l>0){var t=n((l-i)/e.e);if(!t)return;for(var a=L(8,8).map(e=>Math.pow(2,e));I(e.b)>t;){var r=a.pop();(e.b&r)==r&&(e.b-=r)}e.v=W(e.b,e.e)}o.push(e),i+=e.v}),o})(r,i,f.v);if(0==h.length)return console.warn(r.n+" has nothing of value to you."),void q();e={o:[f],p:h},v={t:"That's my offer. Do we have a deal?",o:["Accept","Counter"]},u()},N=(e,t,l,a,o,i)=>l<e&&e<l+o&&a<t&&t<a+i;f.addEventListener("click",n=>{if(a=n.offsetX,o=n.offsetY,1==R&&l){var f=l.p,h=l.g?e.o:e.p,s=h.find(e=>e.i==f.i);s||h.push(s={i:f.i,b:0}),(s.b&l.b)==l.b?s.b-=l.b:s.b+=l.b}t&&("Start"==t.t&&(i=F(!0,3,"Bob"),q()),"Accept"==t.t&&(t=>{c(e.o,e=>H(r,e)),c(e.p,e=>H(i,e)),e=null;var l=255==z(i,0).b,a=255==z(r,0).b;v=l&&a?{t:"A draw! How disappointing!",o:["Start"]}:l?{t:"You won!",o:["Start"]}:a?{t:r.n+" won. :(",o:["Start"]}:{t:"A pleasure doing business!",o:["Next"]},u()})(),"Counter"==t.t&&(v={t:"Wow, that's kinda insulting. But okay. Click on the chunks to make me a better offer, if you can.",o:["Offer","Cancel"]},R=1,e={o:[],p:[]},u()),"Offer"==t.t&&(v={t:"What an offer! Hello hello hello hello hello!",o:[]},u()),"Cancel"==t.t&&Y(),"Next"==t.t&&q()),u()}),f.addEventListener("mousemove",e=>{var i;e.preventDefault(),e.stopPropagation(),a=e?e.offsetX:a,o=e?e.offsetY:o,1==R&&(s.p.forEach(e=>{e.c.forEach(t=>{(t.h=N(a,o,t.x,t.y,e.cw,e.cw))&&(i=t)})}),s.o.forEach(e=>{e.c.forEach(t=>{(t.h=N(a,o,t.x,t.y,e.cw,e.cw))&&(i=t)})}),l=i||null,i=0),s.t.o.forEach(e=>{(e.s=N(a,o,e.x,e.y,e.w,e.h))&&(i=e)}),f.style.cursor=i?"pointer":"default",t=i||null}),window.addEventListener("resize",u,!0),window.addEventListener("orientationchange",u,!0),u(),requestAnimationFrame(w);</script></body></html>